<app-report-header [reportTitle]="reportTitle"
        [userName]="`${currentUser?.firstName} ${currentUser?.lastName}`"></app-report-header>
<div style="display: flex; justify-content: space-between; align-items: center;">
    <nz-range-picker nzMode="month" [(ngModel)]="dateMonthsRange" (ngModelChange)="onMonthRangeChange($event)"></nz-range-picker>
    <nz-select [ngModel]="categoryFilterValue" style="min-width: 200px;"
    (ngModelChange)="onCategoryFilterChange($event)">
        <nz-option  [nzValue]="''" nzLabel="All"></nz-option>
        @for (category of listOfCategories; track $index) {
            <nz-option [nzValue]="category" [nzLabel]="category"></nz-option>
        } 
    </nz-select>
</div>

@for(monthlyReport of report?.monthlyReports; track $index){
    <div class="month-year-date">
        {{getFormattedMonthAndYear(monthlyReport.reportMonthAndYear)}}
    </div>
    <app-report-listing
        [listOfColumns]="listOfColumns"
        [tableData]="monthlyReport.reportRecords"></app-report-listing>
}

@if(report){
    <div class="yearly-totals-section">
        <div>{{totalsTitle}}</div>
        <div class="totals-and-range-container">
            <div class="yearly-totals">
                @for (total of report?.yearTotals; track $index) {
                    <div>{{`${total.category} : ${total.percentage}%`}}</div>
                }
            </div>
            <div class="months-range">
                {{getMonthRange}}
            </div>
        </div>
    </div>
}